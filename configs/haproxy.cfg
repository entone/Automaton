# this config needs haproxy-1.1.28 or haproxy-1.2.1
global
  log  127.0.0.1  local0
  log  127.0.0.1  local1 notice
  maxconn  4096
  daemon

defaults
  log   global
  mode  http
  option  httplog
  option  dontlognull
  retries  3
  option  redispatch
  option  http-server-close
  maxconn  2000
  contimeout  5000
  clitimeout  50000
  srvtimeout  50000

#this frontend interface receives the incoming http requests
frontend public
    bind *:80
    acl is_static path_beg -i /static
    use_backend www if is_static
    default_backend ws
#nginx backend, transfer to port 9000
backend www
    timeout server 30s
    server www1 127.0.0.1:8080

#automaton backend, transfer to port 8000
backend ws
    timeout server 600s
    server ws1 127.0.0.1:8000